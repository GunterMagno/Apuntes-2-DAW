<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resumen Express.js - Wiki 2º DAW</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .summary-table {
            width: 100%;
            border-collapse: collapse;
            margin: var(--spacing-md) 0;
            background-color: var(--bg-card);
            border-radius: var(--radius-md);
            overflow: hidden;
        }
        .summary-table thead {
            background-color: var(--accent-primary);
            color: var(--bg-primary);
        }
        .summary-table th, .summary-table td {
            padding: var(--spacing-sm) var(--spacing-md);
            text-align: left;
            border-bottom: 1px solid var(--bg-tertiary);
        }
        .summary-table th {
            font-weight: 700;
            font-size: 1.1rem;
        }
        .summary-table td:first-child {
            font-family: 'Courier New', monospace;
            color: var(--express-color);
            font-weight: 600;
        }
        .summary-table tr:hover {
            background-color: var(--bg-card-hover);
        }
        .summary-table code {
            background-color: var(--bg-primary);
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <i class="fas fa-book-open"></i>
                <h1>Wiki 2º DAW</h1>
            </div>
            <a href="../index.html" class="back-button">
                <i class="fas fa-arrow-left"></i> Volver al inicio
            </a>
        </div>
    </nav>

    <div class="detail-page">
        <div class="detail-header">
            <div class="detail-icon" style="color: var(--express-color);">
                <i class="fas fa-server"></i>
            </div>
            <h1 class="detail-title">Resumen Rápido: Express.js</h1>
            <p class="detail-subtitle">Referencia rápida de métodos, middleware y rutas</p>
        </div>

        <!-- Setup básico -->
        <div class="content-section">
            <h2><i class="fas fa-play"></i> Comandos de inicio</h2>
            
            <table class="summary-table">
                <thead>
                    <tr>
                        <th>Comando</th>
                        <th>Descripción</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>npm install express</td>
                        <td>Instala Express en tu proyecto</td>
                    </tr>
                    <tr>
                        <td>npm install -D nodemon</td>
                        <td>Instala nodemon para desarrollo (auto-reload)</td>
                    </tr>
                    <tr>
                        <td>const app = express()</td>
                        <td>Crea una instancia de la aplicación Express</td>
                    </tr>
                    <tr>
                        <td>app.listen(port, callback)</td>
                        <td>Inicia el servidor en el puerto especificado</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Métodos HTTP -->
        <div class="content-section">
            <h2><i class="fas fa-route"></i> Métodos de ruta (HTTP Verbs)</h2>
            
            <table class="summary-table">
                <thead>
                    <tr>
                        <th>Método</th>
                        <th>Propósito</th>
                        <th>Ejemplo</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>app.get(path, handler)</td>
                        <td>Obtener datos (leer recursos)</td>
                        <td>app.get('/users', (req, res) => {...})</td>
                    </tr>
                    <tr>
                        <td>app.post(path, handler)</td>
                        <td>Crear nuevos recursos</td>
                        <td>app.post('/users', (req, res) => {...})</td>
                    </tr>
                    <tr>
                        <td>app.put(path, handler)</td>
                        <td>Actualizar recurso completo</td>
                        <td>app.put('/users/:id', (req, res) => {...})</td>
                    </tr>
                    <tr>
                        <td>app.patch(path, handler)</td>
                        <td>Actualizar parcialmente un recurso</td>
                        <td>app.patch('/users/:id', (req, res) => {...})</td>
                    </tr>
                    <tr>
                        <td>app.delete(path, handler)</td>
                        <td>Eliminar un recurso</td>
                        <td>app.delete('/users/:id', (req, res) => {...})</td>
                    </tr>
                    <tr>
                        <td>app.all(path, handler)</td>
                        <td>Maneja todos los métodos HTTP</td>
                        <td>app.all('/secret', requireAuth)</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Objeto Request (req) -->
        <div class="content-section">
            <h2><i class="fas fa-inbox"></i> Objeto Request (req) - Datos de entrada</h2>
            <p>Propiedades y métodos del objeto request para acceder a datos de la petición.</p>
            
            <table class="summary-table">
                <thead>
                    <tr>
                        <th>Propiedad/Método</th>
                        <th>Qué contiene</th>
                        <th>Ejemplo</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>req.params</td>
                        <td>Parámetros de ruta (path parameters)</td>
                        <td>'/users/:id' → req.params.id</td>
                    </tr>
                    <tr>
                        <td>req.query</td>
                        <td>Parámetros de query string</td>
                        <td>'/search?name=Juan' → req.query.name</td>
                    </tr>
                    <tr>
                        <td>req.body</td>
                        <td>Cuerpo de la petición (POST/PUT)</td>
                        <td>req.body.email (necesita middleware express.json())</td>
                    </tr>
                    <tr>
                        <td>req.headers</td>
                        <td>Cabeceras HTTP de la petición</td>
                        <td>req.headers['content-type']</td>
                    </tr>
                    <tr>
                        <td>req.method</td>
                        <td>Método HTTP usado</td>
                        <td>'GET', 'POST', 'PUT', etc.</td>
                    </tr>
                    <tr>
                        <td>req.url</td>
                        <td>URL de la petición</td>
                        <td>'/users?page=2'</td>
                    </tr>
                    <tr>
                        <td>req.path</td>
                        <td>Path sin query string</td>
                        <td>'/users'</td>
                    </tr>
                    <tr>
                        <td>req.cookies</td>
                        <td>Cookies de la petición</td>
                        <td>req.cookies.sessionId (necesita cookie-parser)</td>
                    </tr>
                    <tr>
                        <td>req.ip</td>
                        <td>IP del cliente</td>
                        <td>'192.168.1.1'</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Objeto Response (res) -->
        <div class="content-section">
            <h2><i class="fas fa-share"></i> Objeto Response (res) - Enviar respuestas</h2>
            
            <table class="summary-table">
                <thead>
                    <tr>
                        <th>Método</th>
                        <th>Qué hace</th>
                        <th>Ejemplo</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>res.send(data)</td>
                        <td>Envía respuesta (auto-detecta tipo)</td>
                        <td>res.send('Hola'), res.send({name: 'Juan'})</td>
                    </tr>
                    <tr>
                        <td>res.json(obj)</td>
                        <td>Envía respuesta JSON</td>
                        <td>res.json({ users: [...] })</td>
                    </tr>
                    <tr>
                        <td>res.status(code)</td>
                        <td>Establece código de estado HTTP</td>
                        <td>res.status(404).send('Not found')</td>
                    </tr>
                    <tr>
                        <td>res.sendFile(path)</td>
                        <td>Envía un archivo</td>
                        <td>res.sendFile(__dirname + '/index.html')</td>
                    </tr>
                    <tr>
                        <td>res.redirect(url)</td>
                        <td>Redirige a otra URL</td>
                        <td>res.redirect('/login')</td>
                    </tr>
                    <tr>
                        <td>res.render(view, data)</td>
                        <td>Renderiza una vista (template engine)</td>
                        <td>res.render('index', { title: 'Home' })</td>
                    </tr>
                    <tr>
                        <td>res.set(header, value)</td>
                        <td>Establece cabecera HTTP</td>
                        <td>res.set('Content-Type', 'text/html')</td>
                    </tr>
                    <tr>
                        <td>res.cookie(name, value)</td>
                        <td>Establece una cookie</td>
                        <td>res.cookie('user', 'Juan', { maxAge: 900000 })</td>
                    </tr>
                    <tr>
                        <td>res.download(path)</td>
                        <td>Descarga un archivo</td>
                        <td>res.download('/files/report.pdf')</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Middleware -->
        <div class="content-section">
            <h2><i class="fas fa-layer-group"></i> Middleware incorporado y de terceros</h2>
            <p>Los middleware procesan las peticiones antes de llegar a las rutas.</p>
            
            <table class="summary-table">
                <thead>
                    <tr>
                        <th>Middleware</th>
                        <th>Qué hace</th>
                        <th>Uso</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>express.json()</td>
                        <td>Parsea el body JSON de peticiones</td>
                        <td>app.use(express.json())</td>
                    </tr>
                    <tr>
                        <td>express.urlencoded()</td>
                        <td>Parsea datos de formularios</td>
                        <td>app.use(express.urlencoded({extended: true}))</td>
                    </tr>
                    <tr>
                        <td>express.static(dir)</td>
                        <td>Sirve archivos estáticos</td>
                        <td>app.use(express.static('public'))</td>
                    </tr>
                    <tr>
                        <td>cors()</td>
                        <td>Habilita CORS (peticiones cross-origin)</td>
                        <td>const cors = require('cors'); app.use(cors())</td>
                    </tr>
                    <tr>
                        <td>morgan()</td>
                        <td>Logger de peticiones HTTP</td>
                        <td>const morgan = require('morgan'); app.use(morgan('dev'))</td>
                    </tr>
                    <tr>
                        <td>cookie-parser()</td>
                        <td>Parsea cookies</td>
                        <td>const cookieParser = require('cookie-parser'); app.use(cookieParser())</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Parámetros de ruta -->
        <div class="content-section">
            <h2><i class="fas fa-map-signs"></i> Parámetros de ruta</h2>
            
            <table class="summary-table">
                <thead>
                    <tr>
                        <th>Patrón</th>
                        <th>Ejemplo de ruta</th>
                        <th>URL que coincide</th>
                        <th>Cómo acceder</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>:parametro</td>
                        <td>/users/:id</td>
                        <td>/users/123</td>
                        <td>req.params.id</td>
                    </tr>
                    <tr>
                        <td>Múltiples params</td>
                        <td>/users/:userId/posts/:postId</td>
                        <td>/users/5/posts/10</td>
                        <td>req.params.userId, req.params.postId</td>
                    </tr>
                    <tr>
                        <td>Parámetro opcional</td>
                        <td>/users/:id?</td>
                        <td>/users o /users/123</td>
                        <td>req.params.id (puede ser undefined)</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Router -->
        <div class="content-section">
            <h2><i class="fas fa-sitemap"></i> Express Router - Organizar rutas</h2>
            <p>El Router permite organizar rutas en módulos separados.</p>
            
            <table class="summary-table">
                <thead>
                    <tr>
                        <th>Método</th>
                        <th>Qué hace</th>
                        <th>Ejemplo</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>express.Router()</td>
                        <td>Crea un nuevo router</td>
                        <td>const router = express.Router()</td>
                    </tr>
                    <tr>
                        <td>router.get/post/put/delete</td>
                        <td>Define rutas en el router</td>
                        <td>router.get('/list', handler)</td>
                    </tr>
                    <tr>
                        <td>app.use(path, router)</td>
                        <td>Monta el router en un path</td>
                        <td>app.use('/api/users', userRouter)</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Manejo de errores -->
        <div class="content-section">
            <h2><i class="fas fa-exclamation-triangle"></i> Manejo de errores</h2>
            
            <table class="summary-table">
                <thead>
                    <tr>
                        <th>Técnica</th>
                        <th>Descripción</th>
                        <th>Ejemplo</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Error middleware</td>
                        <td>Middleware con 4 parámetros (err, req, res, next)</td>
                        <td>app.use((err, req, res, next) => {...})</td>
                    </tr>
                    <tr>
                        <td>next(err)</td>
                        <td>Pasa error al siguiente error handler</td>
                        <td>if (err) return next(err)</td>
                    </tr>
                    <tr>
                        <td>try-catch con async</td>
                        <td>Captura errores en funciones async</td>
                        <td>try { await db.save() } catch(e) { next(e) }</td>
                    </tr>
                    <tr>
                        <td>404 Not Found</td>
                        <td>Middleware al final para rutas no encontradas</td>
                        <td>app.use((req, res) => res.status(404).send('Not Found'))</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Códigos de estado HTTP -->
        <div class="content-section">
            <h2><i class="fas fa-hashtag"></i> Códigos de estado HTTP comunes</h2>
            
            <table class="summary-table">
                <thead>
                    <tr>
                        <th>Código</th>
                        <th>Significado</th>
                        <th>Cuándo usarlo</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>200</td>
                        <td>OK</td>
                        <td>Petición exitosa (GET, PUT exitoso)</td>
                    </tr>
                    <tr>
                        <td>201</td>
                        <td>Created</td>
                        <td>Recurso creado exitosamente (POST)</td>
                    </tr>
                    <tr>
                        <td>204</td>
                        <td>No Content</td>
                        <td>Exitoso sin contenido (DELETE)</td>
                    </tr>
                    <tr>
                        <td>400</td>
                        <td>Bad Request</td>
                        <td>Datos inválidos en la petición</td>
                    </tr>
                    <tr>
                        <td>401</td>
                        <td>Unauthorized</td>
                        <td>No autenticado (falta login)</td>
                    </tr>
                    <tr>
                        <td>403</td>
                        <td>Forbidden</td>
                        <td>Autenticado pero sin permisos</td>
                    </tr>
                    <tr>
                        <td>404</td>
                        <td>Not Found</td>
                        <td>Recurso no existe</td>
                    </tr>
                    <tr>
                        <td>500</td>
                        <td>Internal Server Error</td>
                        <td>Error en el servidor</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Estructura de proyecto típica -->
        <div class="content-section">
            <h2><i class="fas fa-folder-tree"></i> Estructura de proyecto recomendada</h2>
            
            <table class="summary-table">
                <thead>
                    <tr>
                        <th>Carpeta/Archivo</th>
                        <th>Propósito</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>routes/</td>
                        <td>Definiciones de rutas organizadas por recurso</td>
                    </tr>
                    <tr>
                        <td>controllers/</td>
                        <td>Lógica de negocio de cada ruta</td>
                    </tr>
                    <tr>
                        <td>models/</td>
                        <td>Modelos de datos (esquemas Mongoose, etc.)</td>
                    </tr>
                    <tr>
                        <td>middleware/</td>
                        <td>Middleware personalizados (auth, validation, etc.)</td>
                    </tr>
                    <tr>
                        <td>config/</td>
                        <td>Configuración (BD, variables de entorno, etc.)</td>
                    </tr>
                    <tr>
                        <td>public/</td>
                        <td>Archivos estáticos (CSS, JS, imágenes)</td>
                    </tr>
                    <tr>
                        <td>app.js o index.js</td>
                        <td>Punto de entrada de la aplicación</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="content-section">
            <div class="info-box">
                <h4><i class="fas fa-lightbulb"></i> Consejo importante</h4>
                <p><strong>Express es minimalista y flexible</strong>. No te impone una estructura, tú decides cómo organizar tu código.</p>
                <p><strong>Patrón común:</strong> Router → Controller → Model → Database. Las rutas delegan a controllers, los controllers usan models para acceder a datos.</p>
                <p><strong>El middleware es clave:</strong> Úsalo para autenticación, validación, logging, manejo de errores. Se ejecutan en el orden que los defines con app.use().</p>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Wiki Personal 2º DAW</p>
        </div>
    </footer>

    <script src="../js/main.js"></script>
</body>
</html>
