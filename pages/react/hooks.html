<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <title>Hooks - React</title>
    <link rel="stylesheet" href="../../css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo"><i class="fas fa-book-open"></i><h1>Wiki 2¬∫ DAW</h1></div>
            <a href="../../index.html" class="back-button"><i class="fas fa-arrow-left"></i> Volver</a>
        </div>
    </nav>
    <div class="content-with-sidebar">
        <aside class="sidebar">
            <h3 class="sidebar-title"><i class="fab fa-react"></i> Hooks</h3>
            <ul class="sidebar-nav">
                <li><a href="#introduccion" class="active">¬øQu√© son los Hooks?</a></li>
                <li><a href="#usestate">useState</a></li>
                <li><a href="#useeffect">useEffect</a></li>
                <li><a href="#usecontext">useContext</a></li>
                <li><a href="#otros-hooks">Otros Hooks</a></li>
                <li><a href="#custom">Custom Hooks</a></li>
                <li><a href="#reglas">Reglas de los Hooks</a></li>
            </ul>
        </aside>
        <main class="main-content">
            <div class="detail-header">
                <div class="detail-icon" style="color:var(--react-color)"><i class="fab fa-react"></i></div>
                <h1>3. Hooks en React</h1>
                <p class="detail-subtitle">Estado y efectos en componentes funcionales</p>
            </div>

            <div class="content-section" id="introduccion">
                <h2><i class="fas fa-fish"></i> ¬øQu√© son los Hooks?</h2>
                <p><strong>Hooks</strong> son funciones especiales que permiten "enganchar" funcionalidades de React (estado, ciclo de vida, contexto) en componentes funcionales.</p>

                <div class="info-box">
                    <p><strong>Antes de Hooks (React &lt; 16.8):</strong></p>
                    <ul>
                        <li>Para usar estado necesitabas Class Components</li>
                        <li>Ciclo de vida solo en clases (componentDidMount, etc.)</li>
                        <li>L√≥gica compleja dif√≠cil de reutilizar</li>
                    </ul>
                    <p><strong>Con Hooks (React 16.8+):</strong></p>
                    <ul>
                        <li>Estado en componentes funcionales</li>
                        <li>Efectos secundarios f√°ciles de manejar</li>
                        <li>L√≥gica reutilizable con custom hooks</li>
                        <li>C√≥digo m√°s limpio y f√°cil de entender</li>
                    </ul>
                </div>

                <h3>Hooks principales:</h3>
                <div class="code-block"><pre>useState     ‚Üí Manejo de estado
useEffect    ‚Üí Efectos secundarios (APIs, suscripciones, etc.)
useContext   ‚Üí Consumir contexto (estado global)
useRef       ‚Üí Referencias a elementos DOM
useReducer   ‚Üí Estado complejo (alternativa a useState)
useMemo      ‚Üí Memoizaci√≥n de valores (optimizaci√≥n)
useCallback  ‚Üí Memoizaci√≥n de funciones (optimizaci√≥n)</pre></div>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è Hooks solo funcionan en:</strong>
                    <ul>
                        <li>‚úì Componentes funcionales de React</li>
                        <li>‚úì Custom Hooks (funciones que empiezan con "use")</li>
                        <li>‚ùå Clases, funciones normales, bucles, condicionales</li>
                    </ul>
                </div>
            </div>

            <div class="content-section" id="usestate">
                <h2><i class="fas fa-database"></i> useState - Manejo de Estado</h2>
                <p><strong>useState</strong> permite a√±adir estado a componentes funcionales. Devuelve un array con [valor, funci√≥n para actualizar].</p>

                <h3>Sintaxis b√°sica:</h3>
                <div class="code-block"><pre>import { useState } from 'react';

function Contador() {
  // [estado, funci√≥n setter] = useState(valor inicial)
  const [count, setCount] = useState(0);
  
  return (
    &lt;div&gt;
      &lt;p&gt;Contador: {count}&lt;/p&gt;
      &lt;button onClick={() => setCount(count + 1)}&gt;Incrementar&lt;/button&gt;
      &lt;button onClick={() => setCount(count - 1)}&gt;Decrementar&lt;/button&gt;
      &lt;button onClick={() => setCount(0)}&gt;Resetear&lt;/button&gt;
    &lt;/div&gt;
  );
}</pre></div>

                <h3>Tipos de estado:</h3>
                <div class="code-block"><pre>// N√∫mero
const [edad, setEdad] = useState(0);

// String
const [nombre, setNombre] = useState('');

// Boolean
const [activo, setActivo] = useState(false);

// Array
const [items, setItems] = useState([]);

// Objeto
const [usuario, setUsuario] = useState({ nombre: '', email: '' });

// Funci√≥n (para inicializaci√≥n costosa)
const [datos, setDatos] = useState(() => {
  // Solo se ejecuta en el primer render
  return calcularDatosComplejos();
});</pre></div>

                <h3>Actualizar estado de objetos y arrays:</h3>
                <div class="code-block"><pre>// ‚ùå INCORRECTO: Mutaci√≥n directa
function App() {
  const [usuario, setUsuario] = useState({ nombre: 'Ana', edad: 25 });
  
  const cumpleanios = () => {
    usuario.edad++; // ‚ùå Esto NO funciona!
    setUsuario(usuario);
  };
}

// ‚úì CORRECTO: Crear nuevo objeto/array
function App() {
  const [usuario, setUsuario] = useState({ nombre: 'Ana', edad: 25 });
  
  const cumpleanios = () => {
    setUsuario({ ...usuario, edad: usuario.edad + 1 });
  };
  
  const cambiarNombre = (nuevoNombre) => {
    setUsuario({ ...usuario, nombre: nuevoNombre });
  };
}

// Arrays
function ListaTareas() {
  const [tareas, setTareas] = useState([]);
  
  // Agregar
  const agregarTarea = (tarea) => {
    setTareas([...tareas, tarea]);
  };
  
  // Eliminar
  const eliminarTarea = (id) => {
    setTareas(tareas.filter(t => t.id !== id));
  };
  
  // Modificar
  const completarTarea = (id) => {
    setTareas(tareas.map(t => 
      t.id === id ? { ...t, completada: true } : t
    ));
  };
}</pre></div>

                <h3>Formularios con useState:</h3>
                <div class="code-block"><pre>function FormularioRegistro() {
  const [form, setForm] = useState({
    nombre: '',
    email: '',
    password: ''
  });
  
  // Manejar cambios en cualquier campo
  const handleChange = (e) => {
    setForm({
      ...form,
      [e.target.name]: e.target.value
    });
  };
  
  const handleSubmit = (e) => {
    e.preventDefault();
    console.log('Datos:', form);
  };
  
  return (
    &lt;form onSubmit={handleSubmit}&gt;
      &lt;input 
        name="nombre"
        value={form.nombre}
        onChange={handleChange}
        placeholder="Nombre"
      /&gt;
      &lt;input 
        name="email"
        value={form.email}
        onChange={handleChange}
        placeholder="Email"
      /&gt;
      &lt;input 
        name="password"
        type="password"
        value={form.password}
        onChange={handleChange}
        placeholder="Contrase√±a"
      /&gt;
      &lt;button type="submit"&gt;Registrar&lt;/button&gt;
    &lt;/form&gt;
  );
}</pre></div>

                <h3>Estado basado en estado anterior:</h3>
                <div class="code-block"><pre>// ‚ùå Puede causar bugs en actualizaciones m√∫ltiples
const incrementar = () => {
  setCount(count + 1);
};

// ‚úì CORRECTO: Usa funci√≥n con estado previo
const incrementar = () => {
  setCount(prevCount => prevCount + 1);
};

// Ejemplo: m√∫ltiples actualizaciones
const incrementarTresVeces = () => {
  setCount(prevCount => prevCount + 1);
  setCount(prevCount => prevCount + 1);
  setCount(prevCount => prevCount + 1);
  // Incrementa 3 veces correctamente
};</pre></div>
            </div>

            <div class="content-section" id="useeffect">
                <h2><i class="fas fa-sync"></i> useEffect - Efectos Secundarios</h2>
                <p><strong>useEffect</strong> permite ejecutar c√≥digo despu√©s del render: llamadas a APIs, suscripciones, timers, manipulaci√≥n del DOM...</p>

                <h3>Sintaxis b√°sica:</h3>
                <div class="code-block"><pre>import { useEffect } from 'react';

function Component() {
  useEffect(() => {
    // C√≥digo del efecto (se ejecuta despu√©s del render)
    console.log('Componente renderizado');
    
    // Cleanup opcional (se ejecuta antes de desmontar o re-ejecutar)
    return () => {
      console.log('Limpieza');
    };
  }, []); // Array de dependencias
}</pre></div>

                <h3>Casos de uso del array de dependencias:</h3>
                <div class="code-block"><pre>// 1. Sin array: Se ejecuta despu√©s de CADA render
useEffect(() => {
  console.log('Cada render');
});

// 2. Array vac√≠o []: Solo al MONTAR (componentDidMount)
useEffect(() => {
  console.log('Solo una vez al montar');
  
  return () => {
    console.log('Solo al desmontar');
  };
}, []);

// 3. Con dependencias: Cuando cambien las dependencias
useEffect(() => {
  console.log('Cuando count cambie');
}, [count]);

// 4. M√∫ltiples dependencias
useEffect(() => {
  console.log('Cuando count o nombre cambien');
}, [count, nombre]);</pre></div>

                <h3>Ejemplo: Llamada a API</h3>
                <div class="code-block"><pre>function PerfilUsuario({ userId }) {
  const [usuario, setUsuario] = useState(null);
  const [cargando, setCargando] = useState(true);
  const [error, setError] = useState(null);
  
  useEffect(() => {
    // Resetear al cambiar userId
    setCargando(true);
    setError(null);
    
    fetch(`https://api.example.com/users/${userId}`)
      .then(res => res.json())
      .then(data => {
        setUsuario(data);
        setCargando(false);
      })
      .catch(err => {
        setError(err.message);
        setCargando(false);
      });
  }, [userId]); // Re-ejecuta cuando userId cambie
  
  if (cargando) return &lt;p&gt;Cargando...&lt;/p&gt;;
  if (error) return &lt;p&gt;Error: {error}&lt;/p&gt;;
  
  return (
    &lt;div&gt;
      &lt;h2&gt;{usuario.nombre}&lt;/h2&gt;
      &lt;p&gt;{usuario.email}&lt;/p&gt;
    &lt;/div&gt;
  );
}</pre></div>

                <h3>Cleanup: Limpiar recursos</h3>
                <div class="code-block"><pre>// Timer
function Temporizador() {
  const [segundos, setSegundos] = useState(0);
  
  useEffect(() => {
    const interval = setInterval(() => {
      setSegundos(s => s + 1);
    }, 1000);
    
    // Limpiar interval al desmontar
    return () => clearInterval(interval);
  }, []);
  
  return &lt;p&gt;{segundos} segundos&lt;/p&gt;;
}

// Event listeners
function Component() {
  useEffect(() => {
    const handleResize = () => {
      console.log('Ventana redimensionada');
    };
    
    window.addEventListener('resize', handleResize);
    
    // Limpiar listener
    return () => {
      window.removeEventListener('resize', handleResize);
    };
  }, []);
}

// Suscripciones WebSocket
function Chat() {
  useEffect(() => {
    const socket = new WebSocket('ws://...');
    
    socket.onmessage = (event) => {
      console.log(event.data);
    };
    
    // Cerrar conexi√≥n al desmontar
    return () => {
      socket.close();
    };
  }, []);
}</pre></div>

                <h3>Ejemplo completo: Buscador con debounce</h3>
                <div class="code-block"><pre>function Buscador() {
  const [termino, setTermino] = useState('');
  const [resultados, setResultados] = useState([]);
  
  useEffect(() => {
    // No buscar si est√° vac√≠o
    if (termino === '') {
      setResultados([]);
      return;
    }
    
    // Debounce: esperar 500ms antes de buscar
    const timer = setTimeout(() => {
      fetch(`/api/buscar?q=${termino}`)
        .then(res => res.json())
        .then(data => setResultados(data));
    }, 500);
    
    // Cancelar b√∫squeda anterior si el usuario sigue escribiendo
    return () => clearTimeout(timer);
  }, [termino]);
  
  return (
    &lt;div&gt;
      &lt;input 
        value={termino}
        onChange={e => setTermino(e.target.value)}
        placeholder="Buscar..."
      /&gt;
      &lt;ul&gt;
        {resultados.map(r => &lt;li key={r.id}&gt;{r.nombre}&lt;/li&gt;)}
      &lt;/ul&gt;
    &lt;/div&gt;
  );
}</pre></div>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è Errores comunes con useEffect:</strong>
                    <ul>
                        <li>‚ùå Olvidar el array de dependencias (causa re-renders infinitos)</li>
                        <li>‚ùå No limpiar suscripciones/timers (memory leaks)</li>
                        <li>‚ùå Llamar a setState en useEffect sin condici√≥n (loop infinito)</li>
                    </ul>
                </div>
            </div>

            <div class="content-section" id="usecontext">
                <h2><i class="fas fa-share-alt"></i> useContext - Estado Global</h2>
                <p><strong>useContext</strong> permite consumir contexto sin prop drilling (pasar props a trav√©s de muchos niveles).</p>

                <h3>Crear y usar contexto:</h3>
                <div class="code-block"><pre>import { createContext, useContext, useState } from 'react';

// 1. Crear contexto
const UserContext = createContext();

// 2. Provider (componente que provee el contexto)
function App() {
  const [user, setUser] = useState({ nombre: 'Ana', rol: 'admin' });
  
  return (
    &lt;UserContext.Provider value={{ user, setUser }}&gt;
      &lt;Navbar /&gt;
      &lt;Main /&gt;
      &lt;Footer /&gt;
    &lt;/UserContext.Provider&gt;
  );
}

// 3. Consumir contexto con useContext
function Navbar() {
  const { user } = useContext(UserContext);
  
  return (
    &lt;nav&gt;
      &lt;p&gt;Bienvenido, {user.nombre}&lt;/p&gt;
    &lt;/nav&gt;
  );
}

function Profile() {
  const { user, setUser } = useContext(UserContext);
  
  const logout = () => {
    setUser(null);
  };
  
  return (
    &lt;div&gt;
      &lt;h2&gt;{user.nombre}&lt;/h2&gt;
      &lt;p&gt;Rol: {user.rol}&lt;/p&gt;
      &lt;button onClick={logout}&gt;Cerrar sesi√≥n&lt;/button&gt;
    &lt;/div&gt;
  );
}</pre></div>

                <h3>Contexto en archivo separado:</h3>
                <div class="code-block"><pre>// context/AuthContext.js
import { createContext, useContext, useState } from 'react';

const AuthContext = createContext();

export function AuthProvider({ children }) {
  const [user, setUser] = useState(null);
  const [loading, setLoading] = useState(false);
  
  const login = async (email, password) => {
    setLoading(true);
    // L√≥gica de login...
    setUser({ email, nombre: 'Ana' });
    setLoading(false);
  };
  
  const logout = () => {
    setUser(null);
  };
  
  const value = { user, loading, login, logout };
  
  return (
    &lt;AuthContext.Provider value={value}&gt;
      {children}
    &lt;/AuthContext.Provider&gt;
  );
}

// Custom hook para usar el contexto
export function useAuth() {
  const context = useContext(AuthContext);
  if (!context) {
    throw new Error('useAuth debe usarse dentro de AuthProvider');
  }
  return context;
}

// App.js
import { AuthProvider } from './context/AuthContext';

function App() {
  return (
    &lt;AuthProvider&gt;
      &lt;Navbar /&gt;
      &lt;Main /&gt;
    &lt;/AuthProvider&gt;
  );
}

// Cualquier componente
import { useAuth } from './context/AuthContext';

function LoginButton() {
  const { user, login, logout } = useAuth();
  
  if (user) {
    return &lt;button onClick={logout}&gt;Logout&lt;/button&gt;;
  }
  
  return (
    &lt;button onClick={() => login('ana@email.com', '123')}&gt;
      Login
    &lt;/button&gt;
  );
}</pre></div>
            </div>

            <div class="content-section" id="otros-hooks">
                <h2><i class="fas fa-toolbox"></i> Otros Hooks √ötiles</h2>

                <h3>useRef - Referencias</h3>
                <div class="code-block"><pre>import { useRef, useEffect } from 'react';

function Component() {
  const inputRef = useRef(null);
  
  useEffect(() => {
    // Focus autom√°tico al montar
    inputRef.current.focus();
  }, []);
  
  return &lt;input ref={inputRef} /&gt;;
}

// Almacenar valores que no causan re-render
function Timer() {
  const intervalRef = useRef(null);
  
  const start = () => {
    intervalRef.current = setInterval(() => {
      console.log('tick');
    }, 1000);
  };
  
  const stop = () => {
    clearInterval(intervalRef.current);
  };
  
  return (
    &lt;div&gt;
      &lt;button onClick={start}&gt;Iniciar&lt;/button&gt;
      &lt;button onClick={stop}&gt;Parar&lt;/button&gt;
    &lt;/div&gt;
  );
}</pre></div>

                <h3>useMemo - Memoizaci√≥n de valores</h3>
                <div class="code-block"><pre>import { useMemo, useState } from 'react';

function Component({ items }) {
  const [count, setCount] = useState(0);
  
  // C√°lculo costoso solo cuando items cambie
  const total = useMemo(() => {
    console.log('Calculando...');
    return items.reduce((sum, item) => sum + item.precio, 0);
  }, [items]);
  
  return (
    &lt;div&gt;
      &lt;p&gt;Total: ${total}&lt;/p&gt;
      &lt;button onClick={() => setCount(count + 1)}&gt;{count}&lt;/button&gt;
      {/* count cambia pero total NO se recalcula */}
    &lt;/div&gt;
  );
}</pre></div>

                <h3>useCallback - Memoizaci√≥n de funciones</h3>
                <div class="code-block"><pre>import { useCallback, useState } from 'react';

function Parent() {
  const [count, setCount] = useState(0);
  
  // Sin useCallback, se crea nueva funci√≥n en cada render
  const handleClick = useCallback(() => {
    console.log('Clicked');
  }, []); // Funci√≥n estable
  
  return (
    &lt;div&gt;
      &lt;Child onClick={handleClick} /&gt;
      &lt;button onClick={() => setCount(count + 1)}&gt;{count}&lt;/button&gt;
    &lt;/div&gt;
  );
}</pre></div>
            </div>

            <div class="content-section" id="custom">
                <h2><i class="fas fa-magic"></i> Custom Hooks</h2>
                <p><strong>Custom Hooks</strong> permiten extraer l√≥gica reutilizable en funciones personalizadas.</p>

                <h3>Ejemplo: useFetch</h3>
                <div class="code-block"><pre>// hooks/useFetch.js
import { useState, useEffect } from 'react';

function useFetch(url) {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  
  useEffect(() => {
    setLoading(true);
    
    fetch(url)
      .then(res => res.json())
      .then(data => {
        setData(data);
        setLoading(false);
      })
      .catch(err => {
        setError(err.message);
        setLoading(false);
      });
  }, [url]);
  
  return { data, loading, error };
}

export default useFetch;

// Uso en componente
import useFetch from './hooks/useFetch';

function Usuarios() {
  const { data, loading, error } = useFetch('/api/usuarios');
  
  if (loading) return &lt;p&gt;Cargando...&lt;/p&gt;;
  if (error) return &lt;p&gt;Error: {error}&lt;/p&gt;;
  
  return (
    &lt;ul&gt;
      {data.map(user => &lt;li key={user.id}&gt;{user.nombre}&lt;/li&gt;)}
    &lt;/ul&gt;
  );
}</pre></div>

                <h3>Ejemplo: useLocalStorage</h3>
                <div class="code-block"><pre>function useLocalStorage(key, initialValue) {
  const [value, setValue] = useState(() => {
    const stored = localStorage.getItem(key);
    return stored ? JSON.parse(stored) : initialValue;
  });
  
  useEffect(() => {
    localStorage.setItem(key, JSON.stringify(value));
  }, [key, value]);
  
  return [value, setValue];
}

// Uso
function App() {
  const [nombre, setNombre] = useLocalStorage('nombre', '');
  
  return (
    &lt;input 
      value={nombre}
      onChange={e => setNombre(e.target.value)}
    /&gt;
  );
  // Se guarda autom√°ticamente en localStorage
}</pre></div>

                <h3>Ejemplo: useToggle</h3>
                <div class="code-block"><pre>function useToggle(initialValue = false) {
  const [value, setValue] = useState(initialValue);
  
  const toggle = () => setValue(v => !v);
  
  return [value, toggle];
}

// Uso
function Modal() {
  const [isOpen, toggleOpen] = useToggle(false);
  
  return (
    &lt;div&gt;
      &lt;button onClick={toggleOpen}&gt;Abrir Modal&lt;/button&gt;
      {isOpen && (
        &lt;div className="modal"&gt;
          &lt;p&gt;Contenido del modal&lt;/p&gt;
          &lt;button onClick={toggleOpen}&gt;Cerrar&lt;/button&gt;
        &lt;/div&gt;
      )}
    &lt;/div&gt;
  );
}</pre></div>
            </div>

            <div class="content-section" id="reglas">
                <h2><i class="fas fa-gavel"></i> Reglas de los Hooks</h2>

                <div class="warning-box">
                    <strong>üö´ Reglas OBLIGATORIAS:</strong>
                    <ol>
                        <li><strong>Solo llamar Hooks en el nivel superior</strong>
                            <ul>
                                <li>‚ùå No dentro de loops, condiciones o funciones anidadas</li>
                                <li>‚úì Siempre en el mismo orden en cada render</li>
                            </ul>
                        </li>
                        <li><strong>Solo llamar Hooks desde funciones React</strong>
                            <ul>
                                <li>‚úì Componentes funcionales</li>
                                <li>‚úì Custom Hooks</li>
                                <li>‚ùå Funciones JavaScript normales</li>
                            </ul>
                        </li>
                    </ol>
                </div>

                <h3>Ejemplos de errores comunes:</h3>
                <div class="code-block"><pre>// ‚ùå INCORRECTO: Hook dentro de condicional
function Component() {
  if (someCondition) {
    const [count, setCount] = useState(0); // ‚ùå Error!
  }
}

// ‚úì CORRECTO: Condicional dentro del Hook
function Component() {
  const [count, setCount] = useState(0);
  
  if (someCondition) {
    // Usar count aqu√≠
  }
}

// ‚ùå INCORRECTO: Hook dentro de loop
function Component() {
  for (let i = 0; i < 5; i++) {
    useEffect(() => {}); // ‚ùå Error!
  }
}

// ‚ùå INCORRECTO: Hook en funci√≥n normal
function calcular() {
  const [value, setValue] = useState(0); // ‚ùå Error!
}

// ‚úì CORRECTO: Custom Hook
function useCalcular() {
  const [value, setValue] = useState(0); // ‚úì OK (nombre empieza con "use")
  return value;
}</pre></div>

                <div class="info-box">
                    <strong>üí° ESLint plugin:</strong>
                    <p>Instala <code>eslint-plugin-react-hooks</code> para detectar autom√°ticamente errores con hooks:</p>
                    <div class="code-block"><pre>npm install eslint-plugin-react-hooks --save-dev</pre></div>
                </div>
            </div>
        </main>
    </div>
    <script src="../../js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const sections = document.querySelectorAll('.content-section');
            const navLinks = document.querySelectorAll('.sidebar-nav a');
            
            function changeActiveLink() {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (window.pageYOffset >= sectionTop - 100) {
                        current = section.getAttribute('id');
                    }
                });
                
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === '#' + current) {
                        link.classList.add('active');
                    }
                });
            }
            
            window.addEventListener('scroll', changeActiveLink);
        });
    </script>
</body>
</html>