<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring Boot - Wiki 2º DAW</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <i class="fas fa-book-open"></i>
                <h1>Wiki 2º DAW</h1>
            </div>
            <a href="../index.html" class="back-button">
                <i class="fas fa-arrow-left"></i> Volver al inicio
            </a>
        </div>
    </nav>

    <div class="detail-page">
        <div class="detail-header">
            <div class="detail-icon" style="color: var(--spring-color);">
                <i class="fas fa-leaf"></i>
            </div>
            <h1 class="detail-title">Spring Boot</h1>
            <p class="detail-subtitle">Framework Java para aplicaciones empresariales modernas</p>
        </div>

        <!-- ¿Qué es Spring Boot? -->
        <div class="content-section">
            <h2><i class="fas fa-info-circle"></i> ¿Qué es Spring Boot?</h2>
            <p>
                Spring Boot es un framework basado en Spring que simplifica enormemente la creación de aplicaciones 
                Java empresariales. Proporciona configuración automática, servidores embebidos y starter dependencies 
                que permiten crear aplicaciones listas para producción en minutos.
            </p>
            <p>
                A diferencia de Spring tradicional que requiere mucha configuración XML, Spring Boot utiliza el 
                principio de "convención sobre configuración" y permite trabajar con anotaciones Java.
            </p>
            
            <div class="info-box">
                <h4><i class="fas fa-lightbulb"></i> Ventajas de Spring Boot</h4>
                <ul>
                    <li><strong>Configuración automática:</strong> Detecta y configura automáticamente componentes</li>
                    <li><strong>Servidor embebido:</strong> Incluye Tomcat, Jetty o Undertow integrado</li>
                    <li><strong>Starter Dependencies:</strong> Agrupa dependencias relacionadas</li>
                    <li><strong>Production-ready:</strong> Métricas, health checks y monitorización incluidos</li>
                    <li><strong>Sin XML:</strong> Configuración basada en Java y properties</li>
                </ul>
            </div>
        </div>

        <!-- Arquitectura -->
        <div class="content-section">
            <h2><i class="fas fa-sitemap"></i> Arquitectura de Spring Boot</h2>
            
            <h3>Capas de una aplicación Spring Boot</h3>
            <ul>
                <li><strong>Controller:</strong> Maneja las peticiones HTTP (REST API)</li>
                <li><strong>Service:</strong> Contiene la lógica de negocio</li>
                <li><strong>Repository:</strong> Acceso a datos (JPA/Hibernate)</li>
                <li><strong>Model/Entity:</strong> Entidades del dominio</li>
                <li><strong>DTO:</strong> Data Transfer Objects para transferir datos</li>
            </ul>

            <div class="code-block">
                <pre>
src/
├── main/
│   ├── java/
│   │   └── com/
│   │       └── ejemplo/
│   │           └── miapp/
│   │               ├── MiAppApplication.java    // Clase principal
│   │               ├── controller/              // Controllers REST
│   │               ├── service/                 // Lógica de negocio
│   │               ├── repository/              // Acceso a datos
│   │               ├── model/                   // Entidades JPA
│   │               ├── dto/                     // DTOs
│   │               └── config/                  // Configuraciones
│   └── resources/
│       ├── application.properties               // Configuración
│       ├── static/                              // Archivos estáticos
│       └── templates/                           // Plantillas HTML
└── test/                                        // Tests
                </pre>
            </div>
        </div>

        <!-- Dependencias importantes -->
        <div class="content-section">
            <h2><i class="fas fa-puzzle-piece"></i> Dependencias clave (Maven)</h2>
            
            <h3>pom.xml - Configuración Maven</h3>
            <div class="code-block">
                <pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    
    &lt;parent&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;
        &lt;version&gt;3.2.0&lt;/version&gt;
    &lt;/parent&gt;
    
    &lt;groupId&gt;com.ejemplo&lt;/groupId&gt;
    &lt;artifactId&gt;mi-app&lt;/artifactId&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
    
    &lt;dependencies&gt;
        &lt;!-- Spring Boot Web (REST API) --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;/dependency&gt;
        
        &lt;!-- Spring Data JPA (Base de datos) --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
        &lt;/dependency&gt;
        
        &lt;!-- H2 Database (BD en memoria) --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.h2database&lt;/groupId&gt;
            &lt;artifactId&gt;h2&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;/dependency&gt;
        
        &lt;!-- Lombok (reduce código boilerplate) --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
            &lt;artifactId&gt;lombok&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;
        &lt;/dependency&gt;
        
        &lt;!-- Validation (validaciones) --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;
        &lt;/dependency&gt;
        
        &lt;!-- DevTools (recarga automática en desarrollo) --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;
                </pre>
            </div>
        </div>

        <!-- Ejemplos prácticos -->
        <div class="content-section">
            <h2><i class="fas fa-code"></i> Ejemplos prácticos completos</h2>
            
            <h3>1. Clase principal (Application)</h3>
            <div class="code-block">
                <pre>
package com.ejemplo.miapp;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication  // Combina @Configuration, @EnableAutoConfiguration y @ComponentScan
public class MiAppApplication {
    public static void main(String[] args) {
        SpringApplication.run(MiAppApplication.class, args);
    }
}
                </pre>
            </div>

            <h3>2. Entidad JPA con Lombok</h3>
            <div class="code-block">
                <pre>
package com.ejemplo.miapp.model;

import jakarta.persistence.*;
import lombok.*;

@Entity
@Table(name = "usuarios")
@Data                    // Genera getters, setters, toString, equals, hashCode
@NoArgsConstructor       // Constructor sin argumentos
@AllArgsConstructor      // Constructor con todos los argumentos
@Builder                 // Patrón Builder
public class Usuario {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(nullable = false, length = 100)
    private String nombre;
    
    @Column(unique = true, nullable = false)
    private String email;
    
    @Column(nullable = false)
    private String password;
    
    private Integer edad;
    
    @Column(name = "fecha_registro")
    private LocalDateTime fechaRegistro;
    
    @PrePersist
    protected void onCreate() {
        fechaRegistro = LocalDateTime.now();
    }
}
                </pre>
            </div>

            <h3>3. Repository (acceso a datos)</h3>
            <div class="code-block">
                <pre>
package com.ejemplo.miapp.repository;

import com.ejemplo.miapp.model.Usuario;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;
import org.springframework.stereotype.Repository;
import java.util.List;
import java.util.Optional;

@Repository
public interface UsuarioRepository extends JpaRepository&lt;Usuario, Long&gt; {
    
    // Métodos derivados automáticamente
    Optional&lt;Usuario&gt; findByEmail(String email);
    List&lt;Usuario&gt; findByNombreContaining(String nombre);
    List&lt;Usuario&gt; findByEdadGreaterThan(Integer edad);
    boolean existsByEmail(String email);
    
    // Query personalizada con JPQL
    @Query("SELECT u FROM Usuario u WHERE u.edad BETWEEN :min AND :max")
    List&lt;Usuario&gt; findByEdadBetween(Integer min, Integer max);
    
    // Query nativa SQL
    @Query(value = "SELECT * FROM usuarios WHERE email LIKE %:dominio%", 
           nativeQuery = true)
    List&lt;Usuario&gt; findByEmailDomain(String dominio);
}
                </pre>
            </div>

            <h3>4. DTO (Data Transfer Object)</h3>
            <div class="code-block">
                <pre>
package com.ejemplo.miapp.dto;

import jakarta.validation.constraints.*;
import lombok.*;

@Data
@NoArgsConstructor
@AllArgsConstructor
@Builder
public class UsuarioDTO {
    
    private Long id;
    
    @NotBlank(message = "El nombre es obligatorio")
    @Size(min = 3, max = 100, message = "El nombre debe tener entre 3 y 100 caracteres")
    private String nombre;
    
    @NotBlank(message = "El email es obligatorio")
    @Email(message = "El email debe ser válido")
    private String email;
    
    @NotBlank(message = "La contraseña es obligatoria")
    @Size(min = 6, message = "La contraseña debe tener al menos 6 caracteres")
    private String password;
    
    @Min(value = 18, message = "Debe ser mayor de edad")
    @Max(value = 120, message = "Edad no válida")
    private Integer edad;
}
                </pre>
            </div>

            <h3>5. Service (lógica de negocio)</h3>
            <div class="code-block">
                <pre>
package com.ejemplo.miapp.service;

import com.ejemplo.miapp.dto.UsuarioDTO;
import com.ejemplo.miapp.model.Usuario;
import com.ejemplo.miapp.repository.UsuarioRepository;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;
import java.util.List;
import java.util.stream.Collectors;

@Service
@RequiredArgsConstructor  // Inyección de dependencias por constructor
public class UsuarioService {
    
    private final UsuarioRepository usuarioRepository;
    
    @Transactional(readOnly = true)
    public List&lt;UsuarioDTO&gt; obtenerTodos() {
        return usuarioRepository.findAll().stream()
            .map(this::convertirADTO)
            .collect(Collectors.toList());
    }
    
    @Transactional(readOnly = true)
    public UsuarioDTO obtenerPorId(Long id) {
        Usuario usuario = usuarioRepository.findById(id)
            .orElseThrow(() -&gt; new RuntimeException("Usuario no encontrado"));
        return convertirADTO(usuario);
    }
    
    @Transactional
    public UsuarioDTO crear(UsuarioDTO usuarioDTO) {
        // Validar que no exista el email
        if (usuarioRepository.existsByEmail(usuarioDTO.getEmail())) {
            throw new RuntimeException("El email ya está registrado");
        }
        
        Usuario usuario = convertirAEntidad(usuarioDTO);
        Usuario guardado = usuarioRepository.save(usuario);
        return convertirADTO(guardado);
    }
    
    @Transactional
    public UsuarioDTO actualizar(Long id, UsuarioDTO usuarioDTO) {
        Usuario usuario = usuarioRepository.findById(id)
            .orElseThrow(() -&gt; new RuntimeException("Usuario no encontrado"));
        
        usuario.setNombre(usuarioDTO.getNombre());
        usuario.setEmail(usuarioDTO.getEmail());
        usuario.setEdad(usuarioDTO.getEdad());
        
        Usuario actualizado = usuarioRepository.save(usuario);
        return convertirADTO(actualizado);
    }
    
    @Transactional
    public void eliminar(Long id) {
        if (!usuarioRepository.existsById(id)) {
            throw new RuntimeException("Usuario no encontrado");
        }
        usuarioRepository.deleteById(id);
    }
    
    // Métodos auxiliares de conversión
    private UsuarioDTO convertirADTO(Usuario usuario) {
        return UsuarioDTO.builder()
            .id(usuario.getId())
            .nombre(usuario.getNombre())
            .email(usuario.getEmail())
            .edad(usuario.getEdad())
            .build();
    }
    
    private Usuario convertirAEntidad(UsuarioDTO dto) {
        return Usuario.builder()
            .nombre(dto.getNombre())
            .email(dto.getEmail())
            .password(dto.getPassword())
            .edad(dto.getEdad())
            .build();
    }
}
                </pre>
            </div>

            <h3>6. Controller REST API</h3>
            <div class="code-block">
                <pre>
package com.ejemplo.miapp.controller;

import com.ejemplo.miapp.dto.UsuarioDTO;
import com.ejemplo.miapp.service.UsuarioService;
import jakarta.validation.Valid;
import lombok.RequiredArgsConstructor;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;
import java.util.List;

@RestController
@RequestMapping("/api/usuarios")
@RequiredArgsConstructor
@CrossOrigin(origins = "*")  // Permitir CORS
public class UsuarioController {
    
    private final UsuarioService usuarioService;
    
    // GET /api/usuarios - Listar todos
    @GetMapping
    public ResponseEntity&lt;List&lt;UsuarioDTO&gt;&gt; listarTodos() {
        List&lt;UsuarioDTO&gt; usuarios = usuarioService.obtenerTodos();
        return ResponseEntity.ok(usuarios);
    }
    
    // GET /api/usuarios/{id} - Obtener por ID
    @GetMapping("/{id}")
    public ResponseEntity&lt;UsuarioDTO&gt; obtenerPorId(@PathVariable Long id) {
        UsuarioDTO usuario = usuarioService.obtenerPorId(id);
        return ResponseEntity.ok(usuario);
    }
    
    // POST /api/usuarios - Crear nuevo
    @PostMapping
    public ResponseEntity&lt;UsuarioDTO&gt; crear(@Valid @RequestBody UsuarioDTO usuarioDTO) {
        UsuarioDTO creado = usuarioService.crear(usuarioDTO);
        return ResponseEntity.status(HttpStatus.CREATED).body(creado);
    }
    
    // PUT /api/usuarios/{id} - Actualizar
    @PutMapping("/{id}")
    public ResponseEntity&lt;UsuarioDTO&gt; actualizar(
            @PathVariable Long id,
            @Valid @RequestBody UsuarioDTO usuarioDTO) {
        UsuarioDTO actualizado = usuarioService.actualizar(id, usuarioDTO);
        return ResponseEntity.ok(actualizado);
    }
    
    // DELETE /api/usuarios/{id} - Eliminar
    @DeleteMapping("/{id}")
    public ResponseEntity&lt;Void&gt; eliminar(@PathVariable Long id) {
        usuarioService.eliminar(id);
        return ResponseEntity.noContent().build();
    }
}
                </pre>
            </div>

            <h3>7. application.properties (Configuración)</h3>
            <div class="code-block">
                <pre>
# Puerto del servidor
server.port=8080

# Configuración de H2 Database
spring.datasource.url=jdbc:h2:mem:testdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=

# Consola H2 (http://localhost:8080/h2-console)
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

# JPA/Hibernate
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

# Logging
logging.level.root=INFO
logging.level.com.ejemplo.miapp=DEBUG
logging.level.org.hibernate.SQL=DEBUG

# JSON formatting
spring.jackson.serialization.indent-output=true
                </pre>
            </div>
        </div>

        <!-- Comandos útiles -->
        <div class="content-section">
            <h2><i class="fas fa-terminal"></i> Comandos Maven y Spring Boot</h2>
            
            <div class="command-item">
                <code>mvn spring-boot:run</code>
                <span>Ejecuta la aplicación Spring Boot en modo desarrollo</span>
            </div>

            <div class="command-item">
                <code>mvn clean install</code>
                <span>Limpia el proyecto y compila generando el JAR</span>
            </div>

            <div class="command-item">
                <code>mvn clean package</code>
                <span>Empaqueta la aplicación en un JAR ejecutable</span>
            </div>

            <div class="command-item">
                <code>mvn test</code>
                <span>Ejecuta todos los tests del proyecto</span>
            </div>

            <div class="command-item">
                <code>java -jar target/mi-app-1.0.0.jar</code>
                <span>Ejecuta el JAR generado</span>
            </div>

            <div class="command-item">
                <code>mvn dependency:tree</code>
                <span>Muestra el árbol de dependencias del proyecto</span>
            </div>

            <div class="command-item">
                <code>mvn clean</code>
                <span>Limpia los archivos compilados (carpeta target/)</span>
            </div>

            <div class="command-item">
                <code>mvn spring-boot:run -Dspring-boot.run.profiles=dev</code>
                <span>Ejecuta con un perfil específico (dev, prod, etc.)</span>
            </div>
        </div>

        <!-- Recursos adicionales -->
        <div class="content-section">
            <h2><i class="fas fa-link"></i> Recursos adicionales</h2>
            <ul>
                <li><a href="https://spring.io/projects/spring-boot" target="_blank">Spring Boot Official</a> - Documentación oficial</li>
                <li><a href="https://start.spring.io/" target="_blank">Spring Initializr</a> - Generador de proyectos</li>
                <li><a href="https://www.baeldung.com/spring-boot" target="_blank">Baeldung Spring Boot</a> - Tutoriales excelentes</li>
                <li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/" target="_blank">Spring Boot Reference</a> - Guía completa</li>
            </ul>
        </div>
    </div>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Wiki Personal 2º DAW</p>
        </div>
    </footer>

    <script src="../js/main.js"></script>
</body>
</html>
